---
title: Text Generation
description: Complete guide to generating text with Dysporium SDK
---

Learn how to generate text completions using Dysporium SDK.

## Basic Generation

The simplest way to generate text:

```typescript
import { generateText } from '@dysporium-sdk/core';
import { createOpenAI } from '@dysporium-sdk/openai';

const openai = createOpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Write a haiku about programming',
});

console.log(result.text);
```

## Using Messages

For conversational AI, use the messages API:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  messages: [
    { role: 'system', content: 'You are a helpful assistant.' },
    { role: 'user', content: 'What is TypeScript?' },
  ],
});
```

## System Messages

Set a system message to guide model behavior:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  system: 'You are a coding assistant. Always provide code examples.',
  prompt: 'Explain async/await',
});
```

## Parameters

Control generation with parameters:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Write a story',
  maxTokens: 500,        // Maximum length
  temperature: 0.7,      // Creativity (0-2)
  topP: 0.9,            // Nucleus sampling
  stopSequences: ['END'], // Stop tokens
});
```

### Temperature

Controls randomness:
- `0.0` - Deterministic, focused
- `0.7` - Balanced (default)
- `1.0+` - Creative, varied

### Max Tokens

Limit response length. Set based on your use case:

```typescript
// Short responses
maxTokens: 50

// Medium responses
maxTokens: 500

// Long responses
maxTokens: 2000
```

## Advanced Parameters

### Diversity Controls

Control repetition and topic diversity:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Write a creative story',
  frequencyPenalty: 0.5,  // Reduce repetition (-2.0 to 2.0)
  presencePenalty: 0.3,    // Encourage new topics (-2.0 to 2.0)
});
```

- **frequencyPenalty**: Reduces repetition of tokens. Higher values = less repetition
- **presencePenalty**: Encourages new topics. Higher values = more diverse topics

### Top-K Sampling

Use top-k sampling (Anthropic, Qwen):

```typescript
import { createAnthropic } from '@dysporium-sdk/anthropic';

const anthropic = createAnthropic({
  apiKey: process.env.ANTHROPIC_API_KEY,
});

const result = await generateText({
  model: anthropic('claude-3-5-sonnet-20241022'),
  prompt: 'Explain quantum computing',
  topK: 40,  // Consider top 40 tokens
});
```

### Reproducible Outputs

Use a seed for reproducible outputs:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Write a haiku',
  seed: 42,  // Same seed = same output
});
```

### User Tracking

Track end-user IDs for abuse detection:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Hello',
  user: 'user-123',  // End-user identifier
});
```

### Parallel Tool Calls

Allow parallel function execution (OpenAI, Qwen):

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Get weather and calculate 2+2',
  tools: [weatherTool, calculatorTool],
  parallelToolCalls: true,  // Execute tools in parallel
});
```

### Extended Thinking (Anthropic)

Enable extended thinking for Claude 3.5+ models:

```typescript
import { createAnthropic } from '@dysporium-sdk/anthropic';

const anthropic = createAnthropic({
  apiKey: process.env.ANTHROPIC_API_KEY,
});

const result = await generateText({
  model: anthropic('claude-3-5-sonnet-20241022'),
  prompt: 'Solve this complex problem step by step',
  thinking: {
    type: 'enabled',
    budgetTokens: 10000,  // Token budget for thinking
  },
});
```

### Reasoning Models (OpenAI)

Configure reasoning effort for o-series models:

```typescript
const result = await generateText({
  model: openai('o1-preview'),
  prompt: 'Solve this math problem',
  reasoningEffort: 'high',  // 'low' | 'medium' | 'high'
  maxCompletionTokens: 2000,  // Used instead of maxTokens
});
```

### Log Probabilities (OpenAI)

Get token probabilities:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Hello',
  logprobs: true,      // Return log probabilities
  topLogprobs: 5,      // Top 5 probabilities per token
});

if (result.logprobs) {
  result.logprobs.content?.forEach(token => {
    console.log(`Token: ${token.token}, Logprob: ${token.logprob}`);
  });
}
```

## Error Handling

Handle errors gracefully:

```typescript
import { APIError, RateLimitError } from '@dysporium-sdk/openai';

try {
  const result = await generateText({
    model: openai('gpt-5.1'),
    prompt: 'Hello',
  });
} catch (error) {
  if (error instanceof RateLimitError) {
    console.error('Rate limit exceeded. Please wait.');
  } else if (error instanceof APIError) {
    console.error('API error:', error.message);
  } else {
    console.error('Unknown error:', error);
  }
}
```

## Token Estimation

Estimate tokens before making requests:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Hello',
  estimateTokens: true, // Enable token estimation
});

console.log('Estimated input tokens:', result.estimatedTokens?.input);
console.log('Estimated output tokens:', result.estimatedTokens?.output);
console.log('Estimated total tokens:', result.estimatedTokens?.total);
```

For more advanced token counting, see the [Utilities Guide](/guides/utilities).

## Usage Information

Access token usage:

```typescript
const result = await generateText({
  model: openai('gpt-5.1'),
  prompt: 'Hello',
});

console.log('Input tokens:', result.usage.inputTokens);
console.log('Output tokens:', result.usage.outputTokens);
console.log('Total tokens:', result.usage.totalTokens);
```

## Next Steps

- [Streaming Guide](/guides/streaming) - Stream responses in real-time
- [Structured Output](/guides/structured-output) - Get JSON responses
- [Tool Calling](/guides/tool-calling) - Add function calling
- [Utilities Guide](/guides/utilities) - Token counting, deduplication, cost tracking

